/* =========================================
   P2P Share — Ultra-Modern UI (no HTML changes)
   ========================================= */

/* ---- CSS Reset (modern) ---- */
*,
*::before,
*::after { box-sizing: border-box; }
html, body { height: 100%; }
body, h1, h2, h3, h4, p, figure { margin: 0; }
img, picture, video, canvas, svg { display: block; max-width: 100%; }
input, button, textarea, select { font: inherit; }
button { cursor: pointer; }
:focus { outline: none; }
:focus-visible { outline: 2px solid var(--focus); outline-offset: 2px; }
@media (prefers-reduced-motion: no-preference) {
  :root { scroll-behavior: smooth; }
}

/* ---- Design Tokens ---- */
:root {
  /* Surface */
  --bg: #0b0d12;
  --bg-elev-1: color-mix(in oklab, var(--bg) 85%, #ffffff 15%);
  --bg-elev-2: color-mix(in oklab, var(--bg) 80%, #ffffff 20%);
  --card: color-mix(in oklab, var(--bg) 78%, #ffffff 22%);
  --glass: rgba(255,255,255,0.06);
  --glass-strong: rgba(255,255,255,0.12);

  /* Text */
  --text: #e7ebf3;
  --muted: #a6afc3;
  --subtle: #8b95a9;

  /* Brand / Accent */
  --brand-1: #7c6cff;
  --brand-2: #21d0ff;
  --brand-3: #4af2b8;
  --accent: #5ae2ff;

  /* Status */
  --ok: #35d39e;
  --warn: #f5b94c;
  --err: #ff6b6b;
  --info: #58a6ff;

  /* Borders & Focus */
  --line: rgba(255,255,255,0.12);
  --line-strong: rgba(255,255,255,0.22);
  --focus: #79c0ff;

  /* Shadows */
  --shadow-1: 0 6px 20px rgba(0,0,0,0.25);
  --shadow-2: 0 10px 30px rgba(0,0,0,0.35);

  /* Radii */
  --r-sm: 10px;
  --r-md: 14px;
  --r-lg: 18px;
  --r-xl: 26px;
  --r-pill: 999px;

  /* Spacing */
  --space-1: 6px;
  --space-2: 10px;
  --space-3: 14px;
  --space-4: 18px;
  --space-5: 24px;
  --space-6: 32px;
  --space-7: 44px;

  /* Typography (fluid) */
  --font-sans: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  --fs-xs: clamp(12px, 0.74vw + 9px, 13px);
  --fs-sm: clamp(13px, 0.8vw + 9px, 14px);
  --fs-base: clamp(15px, 0.9vw + 10px, 16px);
  --fs-lg: clamp(18px, 1.2vw + 12px, 20px);
  --fs-xl: clamp(22px, 1.5vw + 14px, 28px);
  --fs-2xl: clamp(28px, 2vw + 16px, 40px);

  /* Layout width */
  --wrap: 980px;

  /* Gradients */
  --grad-brand: linear-gradient(135deg, var(--brand-1), var(--brand-2) 50%, var(--brand-3));
  --grad-soft: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0));

  /* Progress */
  --bar-bg: rgba(255,255,255,0.08);
  --bar-fill: linear-gradient(90deg, #7c6cff, #21d0ff, #4af2b8);
}

/* Light theme (auto) */
@media (prefers-color-scheme: light) {
  :root {
    --bg: #f7f9fc;
    --bg-elev-1: #ffffff;
    --bg-elev-2: #f2f5fb;
    --card: #ffffff;
    --glass: rgba(0,0,0,0.04);
    --glass-strong: rgba(0,0,0,0.08);

    --text: #0f172a;
    --muted: #475569;
    --subtle: #64748b;

    --line: rgba(2,6,23,0.08);
    --line-strong: rgba(2,6,23,0.16);
    --focus: #2563eb;

    --shadow-1: 0 6px 18px rgba(2,6,23,0.08);
    --shadow-2: 0 14px 42px rgba(2,6,23,0.12);

    --bar-bg: rgba(2,6,23,0.08);
  }
}

/* ---- Base ---- */
html { color-scheme: light dark; }
body {
  font-family: var(--font-sans);
  color: var(--text);
  background:
    radial-gradient(1200px 600px at 10% -10%, rgba(124,108,255,0.20), transparent 60%),
    radial-gradient(1200px 800px at 110% 10%, rgba(33,208,255,0.18), transparent 60%),
    var(--bg);
  line-height: 1.45;
  font-size: var(--fs-base);
}

/* Selection */
::selection { background: color-mix(in oklab, var(--brand-2) 35%, transparent); }

/* Scrollbar (WebKit) */
*::-webkit-scrollbar { width: 10px; height: 10px; }
*::-webkit-scrollbar-thumb { background: var(--glass-strong); border-radius: var(--r-pill); }
*::-webkit-scrollbar-thumb:hover { background: color-mix(in oklab, var(--glass-strong), #fff 10%); }

/* ---- Layout ---- */
.app-header {
  position: sticky; top: 0; z-index: 20;
  backdrop-filter: saturate(1.2) blur(10px);
  background: linear-gradient(180deg, rgba(0,0,0,0.35), transparent);
  border-bottom: 1px solid var(--line);
}
.header-inner {
  max-width: var(--wrap);
  margin: 0 auto;
  display: flex; align-items: center; justify-content: space-between;
  gap: var(--space-4);
  padding: var(--space-3) var(--space-5);
}
.brand {
  font-weight: 700;
  font-size: clamp(18px, 1.2vw + 14px, 22px);
  letter-spacing: 0.2px;
  text-decoration: none;
  color: var(--text);
  background: var(--grad-brand);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}
.nav {
  display: flex; align-items: center; gap: 10px;
  padding: 4px;
  border: 1px solid var(--line);
  border-radius: var(--r-pill);
  background: color-mix(in oklab, var(--bg-elev-1) 80%, transparent);
  box-shadow: var(--shadow-1);
}
.nav-link {
  text-decoration: none;
  color: var(--muted);
  font-size: var(--fs-sm);
  padding: 8px 12px;
  border-radius: var(--r-pill);
  transition: color .2s ease, background-color .2s ease, transform .15s ease;
}
.nav-link:hover { color: var(--text); background: var(--glass); }
.nav-link[aria-current="page"],
.nav-link:active { color: var(--text); background: var(--glass-strong); }

.app-main {
  padding: var(--space-7) var(--space-5) var(--space-6);
}
.wrap {
  max-width: var(--wrap);
  margin: 0 auto;
  display: grid;
  gap: var(--space-6);
  container-type: inline-size;
}
.app-footer {
  border-top: 1px solid var(--line);
  background: linear-gradient(0deg, rgba(0,0,0,0.20), transparent);
  padding: var(--space-4) var(--space-5);
  display: flex; justify-content: center;
}
.muted { color: var(--subtle); font-size: var(--fs-sm); }

/* ---- Headings & Text ---- */
h1 {
  font-size: var(--fs-2xl);
  line-height: 1.15;
  font-weight: 800;
  letter-spacing: -0.02em;
  background: var(--grad-brand);
  -webkit-background-clip: text; background-clip: text; color: transparent;
  filter: drop-shadow(0 4px 24px rgba(124,108,255,0.18));
}
.small { color: var(--muted); font-size: var(--fs-sm); }

/* ---- Sections as Glass Cards ---- */
.section {
  border: 1px solid var(--line);
  border-radius: var(--r-xl);
  background:
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)),
    var(--card);
  box-shadow: var(--shadow-1);
  padding: clamp(14px, 2vw + 10px, 24px);
  position: relative;
  overflow: clip;
}
.section::after {
  content: "";
  position: absolute; inset: 0;
  background: radial-gradient(1000px 200px at 10% -10%, rgba(90,226,255,0.10), transparent 40%);
  pointer-events: none;
}

/* ---- Rows & Responsive Flow ---- */
.row {
  display: flex; align-items: center; gap: var(--space-4);
  flex-wrap: wrap;
}

/* ---- Code + QR ---- */
.code {
  font-family: var(--font-mono);
  font-size: clamp(28px, 3.2vw + 14px, 44px);
  letter-spacing: 0.12em;
  font-weight: 800;
  padding: 10px 14px;
  border-radius: var(--r-lg);
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border: 1px dashed var(--line-strong);
  color: var(--text);
  user-select: all;
  position: relative;
  min-width: 12ch;
  text-align: center;
}
.code::before {
  content: "•";
  position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
  color: transparent;
}
.qr {
  width: min(260px, 60cqw);
  height: auto;
  padding: 14px;
  border-radius: var(--r-lg);
  background: #fff;
  border: 1px solid var(--line);
  box-shadow: var(--shadow-1);
}

/* ---- Inputs ---- */
.input, input[type="text"], input[type="file"] {
  width: min(420px, 100%);
  color: var(--text);
  background: color-mix(in oklab, var(--bg-elev-1) 76%, transparent);
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  padding: 12px 14px;
  transition: border-color .2s ease, background-color .2s ease, box-shadow .2s ease, transform .06s ease;
}
.input::placeholder { color: var(--subtle); }
.input:hover { border-color: var(--line-strong); }
.input:focus-visible {
  border-color: color-mix(in oklab, var(--focus) 60%, var(--line));
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--focus) 18%, transparent);
}

/* File input visual tweak */
input[type="file"] {
  padding: 10px 12px;
  max-width: 100%;
  background:
    linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)),
    var(--bg-elev-1);
}

/* ---- Buttons ---- */
.btn {
  --btn-bg: var(--grad-brand);
  --btn-text: #0b1220;
  color: #0b1220;
  background: var(--btn-bg);
  color: var(--btn-text);
  border: 0;
  border-radius: var(--r-pill);
  padding: 12px 18px;
  font-weight: 700;
  letter-spacing: 0.2px;
  display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  box-shadow: 0 6px 20px rgba(124,108,255,0.35);
  transition: transform .08s ease, box-shadow .2s ease, filter .2s ease;
  will-change: transform;
}
.btn:hover { filter: saturate(1.08) brightness(1.02); box-shadow: 0 10px 26px rgba(124,108,255,0.40); }
.btn:active { transform: translateY(1px) scale(0.99); }
.btn:disabled {
  opacity: 0.55; cursor: not-allowed;
  box-shadow: none; filter: grayscale(0.2);
}

/* Subtle secondary button variant if needed */
.btn.secondary {
  --btn-bg: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  --btn-text: var(--text);
  color: var(--text);
  border: 1px solid var(--line);
  box-shadow: none;
}

/* ---- Progress ---- */
.progress {
  --h: 12px;
  width: min(560px, 100%);
  height: var(--h);
  background: var(--bar-bg);
  border-radius: var(--r-pill);
  overflow: hidden;
  border: 1px solid var(--line);
  position: relative;
}
.bar {
  height: 100%;
  min-width: 0%;
  background: var(--bar-fill);
  background-size: 200% 100%;
  transform-origin: left center;
  transition: width .25s ease;
}
@media (prefers-reduced-motion: no-preference) {
  .bar {
    animation: barFlow 2.6s linear infinite;
  }
}
@keyframes barFlow {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}

/* ---- Notices / Status ---- */
.notice {
  border: 1px solid var(--line-strong);
  border-left: 4px solid var(--info);
  background:
    linear-gradient(180deg, rgba(88,166,255,0.12), rgba(88,166,255,0.04)),
    var(--card);
  color: var(--text);
  border-radius: var(--r-lg);
  padding: 14px 16px;
  box-shadow: var(--shadow-1);
}
.notice.ok { border-left-color: var(--ok); }
.notice.warn { border-left-color: var(--warn); }
.notice.err { border-left-color: var(--err); }

/* ---- Helper States ---- */
[hidden], .hidden { display: none !important; }

/* ---- Micro-interactions ---- */
@media (prefers-reduced-motion: no-preference) {
  .section { animation: cardIn .45s ease both; }
  @keyframes cardIn {
    from { opacity: 0; transform: translateY(8px) scale(0.99); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .code {
    animation: pulseGlow 2.6s ease-in-out infinite;
    box-shadow: 0 0 0 0 rgba(124,108,255,0.0);
  }
  @keyframes pulseGlow {
    0%, 100% { box-shadow: 0 0 0 0 rgba(124,108,255,0.0); }
    50% { box-shadow: 0 0 36px 0 rgba(124,108,255,0.18); }
  }
}

/* ---- Tooltips (pure CSS hint via data-title) ---- */
[aria-label],
[data-title] {
  position: relative;
}
[aria-label]:hover::after,
[data-title]:hover::after {
  content: attr(aria-label) attr(data-title);
  position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
  background: var(--bg-elev-2);
  color: var(--text);
  border: 1px solid var(--line);
  border-radius: var(--r-sm);
  padding: 6px 8px;
  font-size: var(--fs-xs);
  white-space: nowrap;
  box-shadow: var(--shadow-1);
  pointer-events: none;
  opacity: 0; animation: fadeIn .18s ease forwards;
}
@keyframes fadeIn { to { opacity: 1; } }

/* ---- Responsive / Mobile tweaks ---- */
@container (max-width: 720px) {
  .row { gap: var(--space-3); }
  .qr { width: 72cqw; }
  .progress { --h: 14px; }
  .header-inner { padding: var(--space-3) var(--space-3); }
}

@media (max-width: 640px) {
  .nav { gap: 6px; padding: 2px; }
  .nav-link { padding: 8px 10px; font-size: var(--fs-xs); }
  .app-main { padding: var(--space-6) var(--space-3) var(--space-5); }
  .section { border-radius: var(--r-lg); }
  .btn { padding: 12px 16px; }
}

/* ---- Utility: alignments and widths within given HTML ---- */
#downloads > a {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  margin: 8px 10px 0 0;
  padding: 10px 14px;
  border-radius: var(--r-pill);
  border: 1px solid var(--line);
  text-decoration: none;
  color: var(--text);
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  transition: border-color .2s ease, transform .06s ease, box-shadow .2s ease;
}
#downloads > a:hover { border-color: var(--line-strong); box-shadow: var(--shadow-1); }
#downloads > a:active { transform: translateY(1px); }

#recvText, #sendText { color: var(--muted); }

/* Make copy button feel attached near code */
#copyCode.btn {
  padding-inline: 14px;
  white-space: nowrap;
}

/* QR container spacing refinement */
#qr.qr { margin-top: 10px; }

/* ---- Safe hover/focus targets ---- */
.btn, .input, .nav-link, #downloads > a {
  min-height: 44px;
}

/* ---- Graceful fallback for no blur environments ---- */
@supports not (backdrop-filter: blur(6px)) {
  .app-header { background: var(--bg-elev-1); }
  .section { background: var(--card); }
}

/* ---- Print minimal ---- */
@media print {
  .app-header, .app-footer, .nav, .btn { display: none !important; }
  .section { box-shadow: none; border-color: #ccc; }
  body { background: #fff; color: #000; }
}
